---
title: "Pest Growth Simulation Report"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r echo=FALSE}
# invalid function
invalid <- function(x){
  if (missing(x) || is.null(x) || length(x) == 0 || is(x, "try-error")) {
    return(TRUE)
  }
  if (is.list(x)) {
    return(all(sapply(x, invalid)))
  }
  else if (is.vector(x)) {
    return(all(is.na(x)))
  }
  else {
    return(FALSE)
  }
}
```


Report generated by the [Predict-A-Pest web app](http://ec2-52-65-31-166.ap-southeast-2.compute.amazonaws.com/predict-a-pest/).

## Selected Location:
Longitude: *`r params$long`*
Latitude: *`r params$lat`*
Region: *`r params$region`*

## Crop information
Crop: *`r params$crop`*
Crop stage of interest: *`r params$stage`*

## Predicted plot

```{r , echo=FALSE, out.width = '100%'}
knitr::include_graphics("phenology.png")
# print(params$plot_pest)

```

## Management action

Potential impacts during risk periods (red bars): \
*`r ifelse(invalid(params$impact1), "No potential impacts are provided.", params$impact1)`* \
*`r ifelse(invalid(params$impact2), "", params$impact2)`*
\
\
Regional considersation (`r params$region` region): \
*`r ifelse(invalid(params$mngaction), "No regional consideration is provided.", params$mngaction)`*

## Table of simulated pest growth

```{r}
knitr::kable(params$dt_pest)

```

